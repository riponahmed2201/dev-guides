# Prefix Sum Technique

Prefix Sum рж╣рж▓рзЛ ржПржХржЯрж┐ ржЕрзНржпрж╛рж░рзЗрж░ ржкрзНрж░рж╛ржХ-ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрж░ржг (Preprocessing) ржХрзМрж╢рж▓, ржпрж╛рж░ ржорж╛ржзрзНржпржорзЗ ржЖржорж░рж╛ ржЕрзНржпрж╛рж░рзЗрж░ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж░рзЗржЮрзНржЬрзЗрж░ ржпрзЛржЧржлрж▓ ржЦрзБржм ржжрзНрж░рзБржд ржмрж╛ $O(1)$ рж╕ржорзЯрзЗ ржмрзЗрж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐ред

## рзз. ржкрзНрж░рж┐ржлрж┐ржХрзНрж╕ рж╕рж╛ржо ржЕрзНржпрж╛рж░рзЗ (Prefix Sum Array)

ржПржХржЯрж┐ ржЕрзНржпрж╛рж░рзЗ A-ржПрж░ ржЬржирзНржп ржкрзНрж░рж┐ржлрж┐ржХрзНрж╕ рж╕рж╛ржо ржЕрзНржпрж╛рж░рзЗ P ржПржоржиржнрж╛ржмрзЗ рждрзИрж░рж┐ ржХрж░рж╛ рж╣рзЯ ржпрзЗржЦрж╛ржирзЗ P[i] = A[0] + A[1] + ... + A[i]ред

#### ЁЯЫа ржХрж░рзНржоржкржжрзНржзрждрж┐ (Step-by-Step Logic)

1. ржПржХржЯрж┐ ржирждрзБржи ржЕрзНржпрж╛рж░рзЗ (ржЙржжрж╛ржГ `prefixSum`) рждрзИрж░рж┐ ржХрж░рзБржи ржпрж╛рж░ рж╕рж╛ржЗржЬ ржорзВрж▓ ржЕрзНржпрж╛рж░рзЗрж░ рж╕ржорж╛ржиред
2. ржирждрзБржи ржЕрзНржпрж╛рж░рзЗрж░ ржкрзНрж░ржержо ржПрж▓рж┐ржорзЗржирзНржЯржЯрж┐ ржорзВрж▓ ржЕрзНржпрж╛рж░рзЗрж░ ржкрзНрж░ржержо ржПрж▓рж┐ржорзЗржирзНржЯрзЗрж░ рж╕ржорж╛ржи рж░рж╛ржЦрзБржиред
3. ржкрж░ржмрж░рзНрждрзА ржкрзНрж░рждрж┐ржЯрж┐ ржЗржиржбрзЗржХрзНрж╕ `i` ржПрж░ ржЬржирзНржп, `prefixSum[i]` рж╣ржмрзЗ ржПрж░ ржЖржЧрзЗрж░ ржкрзНрж░рж┐ржлрж┐ржХрзНрж╕ рж╕рж╛ржо ржПржмржВ ржмрж░рзНрждржорж╛ржи ржПрж▓рж┐ржорзЗржирзНржЯрзЗрж░ ржпрзЛржЧржлрж▓ (`prefixSum[i-1] + arr[i]`)ред

```java
public int[] buildPrefixSum(int[] arr) {
    int n = arr.length;
    int[] prefixSum = new int[n];
    prefixSum[0] = arr[0];
    for (int i = 1; i < n; i++) {
        prefixSum[i] = prefixSum[i - 1] + arr[i];
    }
    return prefixSum;
}
```

```python
def build_prefix_sum(arr):
    n = len(arr)
    prefix_sum = [0] * n
    prefix_sum[0] = arr[0]
    for i in range(1, n):
        prefix_sum[i] = prefix_sum[i-1] + arr[i]
    return prefix_sum
```

## рзи. рж░рзЗржЮрзНржЬ рж╕рж╛ржо ржХрзБрзЯрзЗрж░рж┐ (Range Sum Queries)

ржпржжрж┐ ржЖржорж╛ржжрзЗрж░ ржХрж╛ржЫрзЗ ржкрзНрж░рж┐ржлрж┐ржХрзНрж╕ рж╕рж╛ржо ржЕрзНржпрж╛рж░рзЗ ржерж╛ржХрзЗ, рждржмрзЗ ржЖржорж░рж╛ ржпрзЗржХрзЛржирзЛ рж░рзЗржЮрзНржЬ $[L, R]$-ржПрж░ ржпрзЛржЧржлрж▓ ржирж┐ржЪрзЗрж░ рж╕рзВрждрзНрж░рзЗ ржмрзЗрж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐:

- $Sum(L, R) = P[R] - P[L-1]$ (ржпржжрж┐ $L > 0$ рж╣рзЯ)
- $Sum(0, R) = P[R]$ (ржпржжрж┐ $L = 0$ рж╣рзЯ)

## рзй. ржЗржХрзБржЗрж▓рж┐ржмрзНрж░рж┐ржпрж╝рж╛ржо ржЗржиржбрзЗржХрзНрж╕ (Equilibrium Index)

ржЗржХрзБржЗрж▓рж┐ржмрзНрж░рж┐ржпрж╝рж╛ржо ржЗржиржбрзЗржХрзНрж╕ рж╣рж▓рзЛ ржПржоржи ржПржХржЯрж┐ ржЗржиржбрзЗржХрзНрж╕ ржпрж╛рж░ ржмрж╛ржо ржкрж╛рж╢рзЗрж░ ржПрж▓рж┐ржорзЗржирзНржЯржЧрзБрж▓рзЛрж░ ржпрзЛржЧржлрж▓ ржПржмржВ ржбрж╛ржи ржкрж╛рж╢рзЗрж░ ржПрж▓рж┐ржорзЗржирзНржЯржЧрзБрж▓рзЛрж░ ржпрзЛржЧржлрж▓ рж╕ржорж╛ржиред

#### ЁЯЫа ржХрж░рзНржоржкржжрзНржзрждрж┐ (Step-by-Step Logic)

1. ржкрзНрж░ржержорзЗ ржкрзБрж░рзЛ ржЕрзНржпрж╛рж░рзЗрж░ ржорзЛржЯ ржпрзЛржЧржлрж▓ (`total_sum`) ржмрзЗрж░ ржХрж░рзБржиред
2. `left_sum` рзж ржерзЗржХрзЗ рж╢рзБрж░рзБ ржХрж░рзБржиред
3. ржЕрзНржпрж╛рж░рзЗрж░ ржкрзНрж░рждрж┐ржЯрж┐ ржПрж▓рж┐ржорзЗржирзНржЯ `x` ржПрж░ ржЬржирзНржп:
   - `total_sum` ржерзЗржХрзЗ `x` ржмрж┐ржпрж╝рзЛржЧ ржХрж░рзБржи (ржПржЯрж┐ ржПржЦржи ржУржЗ ржЗржиржбрзЗржХрзНрж╕рзЗрж░ ржбрж╛ржи ржкрж╛рж╢рзЗрж░ ржпрзЛржЧржлрж▓)ред
   - ржпржжрж┐ `left_sum` ржПржмржВ `total_sum` рж╕ржорж╛ржи рж╣рзЯрзЗ ржпрж╛рзЯ, рждржмрзЗ ржмрж░рзНрждржорж╛ржи ржЗржиржбрзЗржХрзНрж╕ржЯрж┐ржЗ ржЗржХрзБржЗрж▓рж┐ржмрзНрж░рж┐ржпрж╝рж╛ржо ржЗржиржбрзЗржХрзНрж╕ред
   - ржЕржирзНржпржерж╛рзЯ, `left_sum`-ржПрж░ рж╕рж╛ржерзЗ `x` ржпрзЛржЧ ржХрж░рзБржи ржПржмржВ ржкрж░рзЗрж░ ржПрж▓рж┐ржорзЗржирзНржЯрзЗ ржпрж╛ржиред

```python
def findEquilibrium(arr):
    total_sum = sum(arr)
    left_sum = 0
    for i, x in enumerate(arr):
        total_sum -= x
        if left_sum == total_sum:
            return i
        left_sum += x
    return -1
```

## рзк. рж╕рж╛ржм-ржЕрзНржпрж╛рж░рзЗ рж╕рж╛ржо ржкрзНрж░ржмрж▓рзЗржорж╕ (Subarray Sum Problems)

ржкрзНрж░рж┐ржлрж┐ржХрзНрж╕ рж╕рж╛ржо ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржорж░рж╛ рж╕рж╣ржЬрзЗржЗ ржПржоржи рж╕рж╛ржм-ржЕрзНржпрж╛рж░рзЗ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐ ржпрж╛рж░ ржпрзЛржЧржлрж▓ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржорж╛ржи $K$-ржПрж░ рж╕ржорж╛ржиред

## рзл. рзиржбрж┐ ржкрзНрж░рж┐ржлрж┐ржХрзНрж╕ рж╕рж╛ржо (2D Prefix Sum)

ржорзНржпрж╛ржЯрзНрж░рж┐ржХрзНрж╕рзЗрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗржУ ржкрзНрж░рж┐ржлрж┐ржХрзНрж╕ рж╕рж╛ржо ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛рзЯред ржПржХрзЗ **Summed-area table** ржмрж▓рж╛ рж╣рзЯред ржПрж░ ржорж╛ржзрзНржпржорзЗ ржорзНржпрж╛ржЯрзНрж░рж┐ржХрзНрж╕рзЗрж░ ржпрзЗржХрзЛржирзЛ рж╕рж╛ржм-ржорзНржпрж╛ржЯрзНрж░рж┐ржХрзНрж╕рзЗрж░ ржпрзЛржЧржлрж▓ $O(1)$ рж╕ржорзЯрзЗ ржмрзЗрж░ ржХрж░рж╛ рж╕ржорзНржнржмред

## рзм. ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржирж╕ (Applications)

- **Range Sum Queries:** ржмрж╛рж░ржмрж╛рж░ рж░рзЗржЮрзНржЬ ржХрзБрзЯрзЗрж░рж┐ ржХрж░рж╛рж░ ржкрзНрж░рзЯрзЛржЬржи рж╣рж▓рзЗред
- **Image Processing:** ржЗржорзЗржЬ ржмрзНрж▓рж╛рж░рж┐ржВ ржмрж╛ ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВрзЯрзЗред
- **Database Indexing:** ржжрзНрж░рзБржд ржбрзЗржЯрж╛ ржПржЧрзНрж░рж┐ржЧрзЗрж╢ржирзЗрж░ ржЬржирзНржпред
- **Subarray Problems:** рж╕рж╛ржм-ржЕрзНржпрж╛рж░рзЗ рж╕ржВржХрзНрж░рж╛ржирзНржд ржмрж┐ржнрж┐ржирзНржи ржЬржЯрж┐рж▓ рж╕ржорж╕рзНржпрж╛ рж╕ржорж╛ржзрж╛ржирзЗред
