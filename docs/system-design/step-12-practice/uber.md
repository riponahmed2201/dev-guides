# Designing Uber / Pathao (Ride Sharing)

**Uber** ‡¶¨‡¶æ **Pathao** ‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶∞‡¶æ‡¶á‡¶° ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø‡¶Ç ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® ‡¶ï‡¶∞‡¶æ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶≠‡¶ø‡¶â‡¶§‡ßá ‡¶ñ‡ßÅ‡¶¨ ‡¶ï‡¶Æ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡•§ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Æ‡ßÇ‡¶≤ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶û‡ßç‡¶ú ‡¶π‡¶≤‡ßã ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ‡ßá ‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡ßÄ‡¶∞ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶ï‡¶æ‡¶õ‡ßá‡¶∞ ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ (**Geospatial Query**) ‡¶è‡¶¨‡¶Ç ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶ï‡¶∞‡¶æ‡•§

## 1. Requirements (‡¶∞‡¶ø‡¶ï‡ßü‡¶∞‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡¶∏)

### Functional Requirements

1.  **Driver Matching:** ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∞‡¶æ‡¶á‡¶° ‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡¶≤‡ßá ‡¶ï‡¶æ‡¶õ‡ßá‡¶∞ ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§
2.  **Tracking:** ‡¶∞‡¶æ‡¶á‡¶° ‡¶ö‡¶≤‡¶æ‡¶ï‡¶æ‡¶≤‡ßÄ‡¶® ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§
3.  **ETA Calculation:** ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞ ‡¶ï‡¶§‡¶ï‡ßç‡¶∑‡¶£‡ßá ‡¶™‡ßå‡¶Å‡¶õ‡¶æ‡¶¨‡ßá ‡¶è‡¶¨‡¶Ç ‡¶ó‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø‡ßá ‡¶Ø‡ßá‡¶§‡ßá ‡¶ï‡¶§‡¶ï‡ßç‡¶∑‡¶£ ‡¶≤‡¶æ‡¶ó‡¶¨‡ßá ‡¶§‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§
4.  **Pricing:** ‡¶¶‡ßÇ‡¶∞‡¶§‡ßç‡¶¨ ‡¶è‡¶¨‡¶Ç ‡¶ü‡ßç‡¶∞‡¶æ‡¶´‡¶ø‡¶ï‡ßá‡¶∞ ‡¶ì‡¶™‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø ‡¶ï‡¶∞‡ßá ‡¶≠‡¶æ‡¶°‡¶º‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ (Surge Pricing)‡•§

### Non-Functional Requirements

1.  **Low Latency:** ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö‡¶ø‡¶Ç ‡¶ñ‡ßÅ‡¶¨ ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá (1 ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü‡ßá‡¶∞ ‡¶ï‡¶Æ)‡•§
2.  **High Availability:** ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶∏‡¶¨‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§
3.  **Consistency:** ‡¶è‡¶ï‡¶á ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞‡¶ï‡ßá ‡¶Ø‡ßá‡¶® ‡¶è‡¶ï‡¶á ‡¶∏‡¶Æ‡¶Ø‡¶º‡ßá ‡¶¶‡ßÅ‡¶á‡¶ú‡¶® ‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡ßÄ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶®‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º (Strong Consistency during matching)‡•§

---

## 2. Capacity Estimation

- **Active Users:** 100 Million Riders, 1 Million Drivers.
- **QPS (Writes):** ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞‡¶∞‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ß© ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßá‡•§
  - 1M Drivers / 3s = **~333k requests/sec**‡•§ ‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶¨‡¶ø‡¶∂‡¶æ‡¶≤ ‡¶∞‡¶æ‡¶á‡¶ü ‡¶≤‡ßã‡¶°‡•§

---

## 3. High-Level Design (HLD)

Uber ‡¶è‡¶∞ ‡¶Ü‡¶∞‡ßç‡¶ï‡¶ø‡¶ü‡ßá‡¶ï‡¶ö‡¶æ‡¶∞ ‡¶Æ‡¶æ‡¶á‡¶ï‡ßç‡¶∞‡ßã‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï‡•§ ‡¶Æ‡ßÇ‡¶≤ ‡¶ï‡¶Æ‡ßç‡¶™‡ßã‡¶®‡ßá‡¶®‡ßç‡¶ü‡¶ó‡ßÅ‡¶≤‡ßã ‡¶π‡¶≤‡ßã:

1.  **WebSockets:** ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶∞‡¶æ‡¶á‡¶°‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§
2.  **Location Service:** ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï ‡¶ï‡¶∞‡ßá‡•§
3.  **Dispatch Service:** ‡¶∞‡¶æ‡¶á‡¶° ‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶ï‡¶∞‡ßá‡•§
4.  **Map Service (Google Maps API):** ‡¶∞‡ßÅ‡¶ü ‡¶è‡¶¨‡¶Ç ETA ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶∂‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§

### Architecture Diagram

‡¶®‡¶ø‡¶ö‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶π‡¶æ‡¶á-‡¶≤‡ßá‡¶≠‡ßá‡¶≤ ‡¶Ü‡¶∞‡ßç‡¶ï‡¶ø‡¶ü‡ßá‡¶ï‡¶ö‡¶æ‡¶∞ ‡¶°‡¶æ‡ßü‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡¶≤‡ßã (Mermaid):

```mermaid
flowchart TD
    %% Nodes
    Driver[üì± Driver App]
    Rider[üì± Rider App]
    LB[‚öñÔ∏è Load Balancer]

    subgraph Services [Back-end Services]
        direction TB
        Dispatch[üöÄ Dispatch Service]
        LocService[üìç Location Service]
        MapService[üó∫Ô∏è Map Service]
        TripService[üìù Trip Service]
    end

    subgraph Storage [Data Layer]
        direction TB
        GeoIndex[(üîπ Redis Geo Index)]
        TripDB[(üíæ Trip DB - SQL)]
    end

    %% Connections
    Driver -->|üìç Update Loc (3s)| LB
    Rider -->|üöó Request Ride| LB

    LB --> LocService
    LB --> Dispatch

    LocService -->|Write| GeoIndex
    Dispatch -->|üîç Find Nearby| GeoIndex
    Dispatch -->|‚è≥ Calc ETA| MapService
    Dispatch -->|üÜï Create Trip| TripService
    TripService --> TripDB

    %% Styling
    classDef mobile fill:#e1f5fe,stroke:#01579b,stroke-width:2px;
    classDef infra fill:#fff3e0,stroke:#e65100,stroke-width:2px;
    classDef service fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px;
    classDef storage fill:#f3e5f5,stroke:#4a148c,stroke-width:2px;

    class Driver,Rider mobile;
    class LB infra;
    class Dispatch,LocService,MapService,TripService service;
    class GeoIndex,TripDB storage;
```

---

## 4. Deep Dive: Geospatial Indexing (Find Nearby Drivers)

‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶¨‡¶°‡¶º ‡¶ö‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶û‡ßç‡¶ú ‡¶π‡¶≤‡ßã: "‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® (x, y) ‡¶è‡¶∞ ‡ßß ‡¶ï‡¶ø.‡¶Æ‡¶ø. ‡¶¨‡ßç‡¶Ø‡¶æ‡¶∏‡¶æ‡¶∞‡ßç‡¶ß‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶ï‡ßã‡¶® ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞‡¶∞‡¶æ ‡¶Ü‡¶õ‡ßá?"

‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ SQL ‡¶ï‡ßÅ‡¶Ø‡¶º‡ßá‡¶∞‡¶ø `SELECT * FROM Drivers WHERE lat < x+r AND lat > x-r...` ‡¶∏‡ßç‡¶ï‡ßá‡¶≤‡ßá‡¶¨‡¶≤ ‡¶®‡¶Ø‡¶º ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶≤‡¶ï‡ßç‡¶∑ ‡¶≤‡¶ï‡ßç‡¶∑ ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ü‡¶ø ‡¶ñ‡ßÅ‡¶¨ ‡¶∏‡ßç‡¶≤‡ßã‡•§ ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶á‡¶®‡¶°‡ßá‡¶ï‡ßç‡¶∏‡¶ø‡¶Ç ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞‡•§

### Approach 1: Geohash (Redis Geo)

‡¶™‡ßÉ‡¶•‡¶ø‡¶¨‡ßÄ‡¶ï‡ßá ‡¶õ‡ßã‡¶ü ‡¶õ‡ßã‡¶ü ‡¶Ü‡¶Ø‡¶º‡¶§‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶ó‡ßç‡¶∞‡¶ø‡¶°‡ßá ‡¶≠‡¶æ‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡•§ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶ó‡ßç‡¶∞‡¶ø‡¶°‡ßá‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶á‡¶â‡¶®‡¶ø‡¶ï ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Ç ‡¶Ü‡¶á‡¶°‡¶ø ‡¶•‡¶æ‡¶ï‡ßá (‡¶Ø‡ßá‡¶Æ‡¶®: `wx4g0e`)‡•§

- ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶∞‡¶æ‡¶á‡¶°‡¶æ‡¶∞ ‡¶Ø‡¶¶‡¶ø ‡¶è‡¶ï‡¶á Geohash ‡¶¨‡¶æ ‡¶§‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¨‡ßá‡¶∂‡ßÄ Geohash ‡¶è ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶¨‡ßá ‡¶§‡¶æ‡¶∞‡¶æ ‡¶ï‡¶æ‡¶õ‡¶æ‡¶ï‡¶æ‡¶õ‡¶ø ‡¶Ü‡¶õ‡ßá‡•§
- **‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ:** Redis ‡¶è‡¶∞ `GEOADD` ‡¶è‡¶¨‡¶Ç `GEORADIUS` ‡¶ï‡¶Æ‡¶æ‡¶®‡ßç‡¶° ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶è‡¶ü‡¶ø ‡¶ñ‡ßÅ‡¶¨ ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶á‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡•§

### Approach 2: QuadTree (Uber's Choice)

‡¶™‡ßÉ‡¶•‡¶ø‡¶¨‡ßÄ‡¶ï‡ßá ‡ß™‡¶ü‡¶ø ‡¶≠‡¶æ‡¶ó‡ßá ‡¶≠‡¶æ‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º, ‡¶è‡¶∞‡¶™‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶≠‡¶æ‡¶ó‡¶ï‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡ß™ ‡¶≠‡¶æ‡¶ó‡ßá... ‡¶è‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ø‡¶§‡¶ï‡ßç‡¶∑‡¶£ ‡¶®‡¶æ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡ßã‡¶ü ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ‡¶Ø‡¶º ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶ï ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞ ‡¶•‡¶æ‡¶ï‡ßá‡•§

- ‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ü‡ßç‡¶∞‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶æ‡¶ï‡¶ö‡¶æ‡¶∞‡•§
- ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶Æ‡ßá‡¶Æ‡ßã‡¶∞‡¶ø‡¶§‡ßá ‡¶ñ‡ßÅ‡¶¨ ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶ü‡ßç‡¶∞‡¶æ‡¶≠‡¶æ‡¶∞‡ßç‡¶∏ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡•§
- Uber ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶®‡¶ø‡¶ú‡¶∏‡ßç‡¶¨ **H3** (Hexagonal Hierarchical Spatial Index) ‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá, ‡¶Ø‡¶æ ‡¶∑‡¶°‡¶º‡¶≠‡ßÅ‡¶ú‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶ó‡ßç‡¶∞‡¶ø‡¶° ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá‡•§ ‡¶∑‡¶°‡¶º‡¶≠‡ßÅ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶¨ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¨‡ßá‡¶∂‡ßÄ ‡¶∏‡¶Æ‡¶æ‡¶® ‡¶¶‡ßÇ‡¶∞‡¶§‡ßç‡¶¨‡ßá ‡¶•‡¶æ‡¶ï‡ßá, ‡¶Ø‡¶æ ‡¶¨‡¶∞‡ßç‡¶ó‡ßá‡¶∞ ‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡ßá ‡¶π‡¶Ø‡¶º ‡¶®‡¶æ‡•§

---

## 5. Deep Dive: Location Updates & Dispatching

### Location Updates (High Write Throughput)

‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞‡¶∞‡¶æ ‡ß© ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞ ‡¶™‡¶∞ ‡¶Æ‡ßÅ‡¶≠ ‡¶ï‡¶∞‡¶õ‡ßá‡•§ ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ø‡¶¶‡¶ø ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¨‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶ø, ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶ï‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ï‡¶∞‡¶¨‡ßá‡•§
**Solution:**

- ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞‡ßá‡¶∞ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá ‡¶™‡¶æ‡¶∞‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü‡¶≤‡¶ø ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶®‡ßá‡¶á (‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶ü‡ßç‡¶∞‡¶ø‡¶™‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶õ‡¶æ‡¶°‡¶º‡¶æ)‡•§
- ‡¶Ü‡¶Æ‡¶∞‡¶æ **Redis** (In-memory) ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶ø ‡¶≤‡ßá‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶∞‡¶æ‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§
- ‡¶™‡ßÅ‡¶∞‡¶æ‡¶®‡ßã ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶°‡¶ø‡¶∏‡¶ï‡¶æ‡¶∞‡ßç‡¶° ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡¶á ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö‡ßá ‡¶Ü‡¶∞‡ßç‡¶ï‡¶æ‡¶á‡¶≠ ‡¶ï‡¶∞‡¶ø‡•§

### Matching Algorithm (Dispatch)

1.  ‡¶∞‡¶æ‡¶á‡¶°‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶Ø‡¶º‡•§
2.  Geospatial Index (Redis) ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡¶æ‡¶õ‡ßá‡¶∞ ‡ßß‡ß¶ ‡¶ú‡¶® ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡¶æ‡¶∞‡¶ï‡ßá ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡•§
3.  ‡¶Ø‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶á‡¶®‡¶≠‡¶æ‡¶á‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º, ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶Æ‡¶Ø‡¶º‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá 'Locked' ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡•§
4.  ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶Ø‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∏‡ßá‡¶™‡ßç‡¶ü ‡¶ï‡¶∞‡ßá, ‡¶§‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∞‡¶æ‡¶á‡¶° ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶∏‡¶æ‡¶á‡¶® ‡¶π‡¶Ø‡¶º‡•§

---

## 6. Database Schema Design

### Trip Database (PostgreSQL)

‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡¶ú‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®‡¶æ‡¶≤ ‡¶°‡¶æ‡¶ü‡¶æ (‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü, ‡¶ü‡ßç‡¶∞‡¶ø‡¶™ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏) ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø **SQL** ‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø‡•§

- `Trips` ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤: TripID, RiderID, DriverID, Status (Requested, Ongoing, Completed), Fare.

### Location Database (Redis + Cassandra)

- **Redis:** ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® (Ephemeral)‡•§
- **Cassandra:** ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø (History) - ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ‡¶§‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶≤‡¶ø‡¶ü‡¶ø‡¶ï‡ßç‡¶∏ ‡¶¨‡¶æ ‡¶ï‡ßç‡¶∞‡¶æ‡¶á‡¶Æ ‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü‡¶ø‡¶ó‡ßá‡¶∂‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§

### Visual Schema Design

‡¶®‡¶ø‡¶ö‡ßá ‡¶è‡¶®‡ßç‡¶ü‡¶ø‡¶ü‡¶ø ‡¶∞‡¶ø‡¶≤‡ßá‡¶∂‡¶®‡¶∂‡¶ø‡¶™ ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡¶≤‡ßã:

```mermaid
erDiagram
    TRIPS {
        UUID TripID PK
        UUID RiderID FK
        UUID DriverID FK
        String Status
        Float Fare
        Timestamp CreatedAt
    }
    RIDERS {
        UUID RiderID PK
        String Name
        String Rating
    }
    DRIVERS {
        UUID DriverID PK
        String Name
        String CarModel
        Float Rating
    }

    RIDERS ||--o{ TRIPS : requests
    DRIVERS ||--o{ TRIPS : accepts
```

---

## 7. Summary

- **Geospatial Index:** QuadTree or Geohash (Redis/H3) to find nearby drivers.
- **Communication:** WebSockets for real-time tracking.
- **Database:** SQL for payments/trips, NoSQL for high-speed location updates.
