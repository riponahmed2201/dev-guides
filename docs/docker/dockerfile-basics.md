# Dockerfile Basics: ржХрж╛рж╕рзНржЯржо ржЗржорзЗржЬ рждрзИрж░рж┐рж░ рж╢рзБрж░рзБ ЁЯПЧя╕П

ржПрждржХрзНрж╖ржг ржЖржорж░рж╛ ржбржХрж╛рж░ рж╣рж╛ржм ржерзЗржХрзЗ рж░рзЗржбрж┐-ржорзЗржб ржЗржорзЗржЬ ржбрж╛ржЙржирж▓рзЛржб ржХрж░рзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗржЫрж┐ред ржХрж┐ржирзНрждрзБ ржмрж╛рж╕рзНрждржм ржЬрзАржмржирзЗ ржЖржкржирж┐ ржпржЦржи ржирж┐ржЬрзЗрж░ ржХрзЛржирзЛ ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржи (Node.js, Python, Java) ржХржирзНржЯрзЗржЗржирж╛рж░рж╛ржЗржЬ ржХрж░рждрзЗ ржЪрж╛ржЗржмрзЗржи, рждржЦржи ржЖржкржирж╛рж░ ржирж┐ржЬрзЗрж░ ржПржХржЯрж┐ ржЗржорзЗржЬ рждрзИрж░рж┐ ржХрж░рждрзЗ рж╣ржмрзЗред ржЖрж░ ржПржЗ ржЗржорзЗржЬ рждрзИрж░рж┐рж░ ржЬржирзНржп ржпрзЗ ржЯрзЗржХрзНрж╕ржЯ ржлрж╛ржЗрж▓ржЯрж┐ ржмрзНржпржмрж╣рзГржд рж╣рзЯ, рждрж╛ржХрзЗржЗ ржмрж▓рж╛ рж╣рзЯ **Dockerfile**ред

---

## рзз. Dockerfile ржХрж┐?

**Dockerfile** рж╣рж▓рзЛ ржПржХржЯрж┐ рж╕рж╛ржзрж╛рж░ржг ржЯрзЗржХрзНрж╕ржЯ ржлрж╛ржЗрж▓ ржпрзЗржЦрж╛ржирзЗ ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ ржХрж┐ржЫрзБ ржЗржирзНрж╕ржЯрзНрж░рж╛ржХрж╢ржи ржмрж╛ ржХржорж╛ржирзНржб рж▓рзЗржЦрж╛ ржерж╛ржХрзЗред ржбржХрж╛рж░ ржПржЗ ржлрж╛ржЗрж▓ржЯрж┐ ржкрзЬрзЗ ржЕржЯрзЛржорзЗржЯрж┐ржХ ржПржХржЯрж┐ ржЗржорзЗржЬ рждрзИрж░рж┐ ржХрж░рзЗ ржлрзЗрж▓рзЗред рж╕рж╣ржЬ ржХржерж╛рзЯ, ржПржЯрж┐ рж╣рж▓рзЛ ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржирзЗрж░ ржЗржорзЗржЬрзЗрж░ ржПржХржЯрж┐ "рж░рзЗрж╕рж┐ржкрж┐"ред

---

## рзи. Dockerfile Structure (ржорзЗржЗржи ржЗржирзНрж╕ржЯрзНрж░рж╛ржХрж╢ржи)

ржПржХржЯрж┐ ржмрзЗрж╕рж┐ржХ Dockerfile-ржП рж╕рж╛ржзрж╛рж░ржгржд ржирж┐ржЪрзЗрж░ ржЗржирзНрж╕ржЯрзНрж░рж╛ржХрж╢ржиржЧрзБрж▓рзЛ ржерж╛ржХрзЗ:

```dockerfile
# рзз. ржмрзЗрж╕ ржЗржорзЗржЬ рж╕рзЗржЯ ржХрж░рж╛
FROM node:18-alpine

# рзи. ржХржирзНржЯрзЗржЗржирж╛рж░рзЗрж░ ржнрзЗрждрж░рзЗ ржХрзЛржи ржлрзЛрж▓рзНржбрж╛рж░рзЗ ржХрж╛ржЬ рж╣ржмрзЗ
WORKDIR /app

# рзй. рж╣рзЛрж╕рзНржЯ ржорзЗрж╢рж┐ржи ржерзЗржХрзЗ ржлрж╛ржЗрж▓ ржХржкрж┐ ржХрж░рж╛
COPY . .

# рзк. ржбрж┐ржкрзЗржиржбрзЗржирзНрж╕рж┐ ржЗржирзНрж╕ржЯрж▓ ржХрж░рж╛
RUN npm install

# рзл. ржкрзЛрж░рзНржЯ ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржи (ржРржЪрзНржЫрж┐ржХ ржХрж┐ржирзНрждрзБ ржЬрж░рзБрж░рж┐)
EXPOSE 3000

# рзм. ржПржиржнрж╛рзЯрж░ржиржорзЗржирзНржЯ ржнрзЗрж░рж┐рзЯрзЗржмрж▓ (ржРржЪрзНржЫрж┐ржХ)
ENV NODE_ENV=production

# рзн. ржХржирзНржЯрзЗржЗржирж╛рж░ ржЪрж╛рж▓рзБ рж╣ржУрзЯрж╛рж░ рж╕ржорзЯ ржХрзЛржи ржХржорж╛ржирзНржб ржЪрж▓ржмрзЗ
CMD ["npm", "start"]
```

---

## рзй. ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржЗржирзНрж╕ржЯрзНрж░рж╛ржХрж╢ржиржЧрзБрж▓рзЛрж░ ржмрзНржпрж╛ржЦрзНржпрж╛

- **`FROM`**: ржкрзНрж░рждрзНржпрзЗржХржЯрж┐ Dockerfile ржЕржмрж╢рзНржпржЗ ржПржЗ ржХржорж╛ржирзНржб ржжрж┐рзЯрзЗ рж╢рзБрж░рзБ рж╣рждрзЗ рж╣ржмрзЗред ржПржЯрж┐ ржарж┐ржХ ржХрж░рзЗ ржжрзЗрзЯ ржЖржкржирж╛рж░ ржЗржорзЗржЬржЯрж┐ ржХрзЛржи ржмрзЗрж╕ ржЗржорзЗржЬрзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ рждрзИрж░рж┐ рж╣ржмрзЗред
- **`RUN`**: ржЗржорзЗржЬ ржмрж┐рж▓рзНржб рж╣ржУрзЯрж╛рж░ рж╕ржорзЯ ржХржирзНржЯрзЗржЗржирж╛рж░рзЗрж░ ржнрзЗрждрж░рзЗ ржХрзЛржирзЛ ржХржорж╛ржирзНржб (ржпрзЗржоржи: `apt update`, `npm install`) ржЪрж╛рж▓рж╛ржирзЛрж░ ржЬржирзНржп ржПржЯрж┐ ржмрзНржпржмрж╣рзГржд рж╣рзЯред
- **`COPY` vs `ADD`**: рж▓рзЛржХрж╛рж▓ ржлрж╛ржЗрж▓ ржЗржорзЗржЬрзЗ ржирзЗржУрзЯрж╛рж░ ржЬржирзНржп `COPY` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯред `ADD` ржПржХржЯрзБ ржмрзЗрж╢рж┐ ржкрж╛ржУрзЯрж╛рж░ржлрзБрж▓ (ржпрзЗржоржи: URL ржерзЗржХрзЗ ржлрж╛ржЗрж▓ ржирж╛ржорж╛ржирзЛ ржмрж╛ ржЖрж░рзНржХрж╛ржЗржн ржлрж╛ржЗрж▓ ржПржХрзНрж╕ржЯрзНрж░рж╛ржХрзНржЯ ржХрж░рж╛), рждржмрзЗ рж╕рж╛ржзрж╛рж░ржг ржХрж╛ржЬрзЗрж░ ржЬржирзНржп `COPY` рж░рзЗржХржорзЗржирзНржбрзЗржбред
- **`CMD`**: ржПржЯрж┐ ржХржирзНржЯрзЗржЗржирж╛рж░ржЯрж┐ "рж░рж╛ржи" рж╣ржУрзЯрж╛рж░ рж╕ржорзЯ ржХрж╛рж░рзНржпржХрж░ рж╣рзЯред ржПржХржЯрж┐ Dockerfile-ржП рж╢рзБржзрзБржорж╛рждрзНрж░ ржПржХржЯрж┐ `CMD` ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗред
- **`WORKDIR`**: ржПржЯрж┐ ржХржирзНржЯрзЗржЗржирж╛рж░рзЗрж░ ржнрзЗрждрж░рзЗ ржЖржкржирж╛рж░ ржХрж╛ржЬрзЗрж░ ржбрж┐рж░рзЗржХрзНржЯрж░рж┐ рж╕рзЗржЯ ржХрж░рзЗ ржжрзЗрзЯ (Linux-ржПрж░ `cd` ржХржорж╛ржирзНржбрзЗрж░ ржорждрзЛ)ред

---

## рзк. Build Context ржПржмржВ .dockerignore

ржЖржкржирж┐ ржпржЦржи `docker build` ржХржорж╛ржирзНржб ржЪрж╛рж▓рж╛ржи, рждржЦржи рж╕рзЗржЗ ржлрзЛрж▓рзНржбрж╛рж░рзЗрж░ рж╕ржм ржлрж╛ржЗрж▓ ржбржХрж╛рж░ ржЗржЮрзНржЬрж┐ржирзЗрж░ ржХрж╛ржЫрзЗ ржкрж╛ржарж╛ржирзЛ рж╣рзЯред ржПржХрзЗ ржмрж▓рзЗ **Build Context**ред
ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржлрж╛ржЗрж▓ (ржпрзЗржоржи: `node_modules`, `.git`, рж▓рж╛рж░рзНржЬ ржлрж╛ржЗрж▓) ржЗржорзЗржЬрзЗ ржпрж╛ржУрзЯрж╛ ржЖржЯржХрж╛рждрзЗ ржЖржорж░рж╛ **`.dockerignore`** ржлрж╛ржЗрж▓ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж┐ред

---

## рзл. Layer Caching (ржмрж┐рж▓рзНржб рж╕рзНржкрж┐ржб ржмрж╛рзЬрж╛ржирзЛ)

ржбржХрж╛рж░ ржкрзНрж░рждрж┐ржЯрж┐ ржЗржирзНрж╕ржЯрзНрж░рж╛ржХрж╢ржиржХрзЗ ржПржХ ржПржХржЯрж┐ **Layer** рж╣рж┐рж╕рзЗржмрзЗ рж╕рзЗржн ржХрж░рзЗ рж░рж╛ржЦрзЗред ржЖржкржирж┐ ржпржжрж┐ ржХрзЛржирзЛ рж▓рж╛ржЗржирзЗ ржкрж░рж┐ржмрж░рзНрждржи ржирж╛ ржХрж░рзЗржи, рждржмрзЗ ржбржХрж╛рж░ ржЖржЧрзЗрж░ ржЬржорж╛ржирзЛ (Cache) рж▓рзЗрзЯрж╛рж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред
**ржЯрж┐ржкрж╕:** рж╕ржмрж╕ржорзЯ ржбрж┐ржкрзЗржиржбрзЗржирзНрж╕рж┐ ржЗржирзНрж╕ржЯрж▓ ржХрж░рж╛рж░ ржзрж╛ржкржЯрж┐ (`RUN npm install`) ржлрж╛ржЗрж▓ ржХржкрж┐ ржХрж░рж╛рж░ ржЖржЧрзЗржЗ ржХрж░рж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржи, ржпрж╛рждрзЗ ржХрзЛржб ржЪрзЗржЮрзНржЬ ржХрж░рж▓рзЗржУ ржбржХрж╛рж░ ржмрж╛рж░ржмрж╛рж░ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржЗржирзНрж╕ржЯрж▓ ржирж╛ ржХрж░рзЗред

---

## рзм. ржХрж┐ржнрж╛ржмрзЗ ржЗржорзЗржЬ ржмрж┐рж▓рзНржб ржХрж░ржмрзЗржи?

ржЯрж╛рж░рзНржорж┐ржирж╛рж▓рзЗ ржЧрж┐рзЯрзЗ ржирж┐ржЪрзЗрж░ ржХржорж╛ржирзНржбржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи (ржпрзЗржЦрж╛ржирзЗ Dockerfile ржЖржЫрзЗ):

```bash
docker build -t my-app:v1 .
```

- `-t`: ржЗржорзЗржЬржЯрж┐ ржЯрзНржпрж╛ржЧ ржмрж╛ ржирж╛ржо ржжрзЗржУрзЯрж╛рж░ ржЬржирзНржпред
- `.`: ржмрж░рзНрждржорж╛ржи ржлрзЛрж▓рзНржбрж╛рж░ржХрзЗ ржмрж┐рж▓рзНржб ржХржирзНржЯрзЗржХрзНрж╕ржЯ рж╣рж┐рж╕рзЗржмрзЗ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржЬржирзНржпред

---

> [!IMPORTANT]
> ржПржХржЯрж┐ ржнрж╛рж▓рзЛ Dockerfile ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржирзЗрж░ ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕ ржПржмржВ рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐ ржмрж╣рзБржЧрзБржг ржмрж╛рзЬрж┐рзЯрзЗ ржжрж┐рждрзЗ ржкрж╛рж░рзЗред ржЪрзЗрж╖рзНржЯрж╛ ржХрж░ржмрзЗржи рж╕ржмрж╕ржорзЯ ржЫрзЛржЯ рж╕рж╛ржЗржЬрзЗрж░ ржмрзЗрж╕ ржЗржорзЗржЬ (ржпрзЗржоржи: `alpine` ржнрж╛рж░рзНрж╕ржи) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗред
