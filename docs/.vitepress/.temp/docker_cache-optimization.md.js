import { ssrRenderAttrs, ssrRenderStyle } from "vue/server-renderer";
import { useSSRContext } from "vue";
import { _ as _export_sfc } from "./plugin-vue_export-helper.1tPrXgE0.js";
const __pageData = JSON.parse('{"title":"Build Cache Optimization ЁЯЪА","description":"","frontmatter":{},"headers":[],"relativePath":"docker/cache-optimization.md","filePath":"docker/cache-optimization.md"}');
const _sfc_main = { name: "docker/cache-optimization.md" };
function _sfc_ssrRender(_ctx, _push, _parent, _attrs, $props, $setup, $data, $options) {
  _push(`<div${ssrRenderAttrs(_attrs)}><h1 id="build-cache-optimization-ЁЯЪА" tabindex="-1">Build Cache Optimization ЁЯЪА <a class="header-anchor" href="#build-cache-optimization-ЁЯЪА" aria-label="Permalink to &quot;Build Cache Optimization ЁЯЪА&quot;">тАЛ</a></h1><p>ржбржХрж╛рж░ ржЗржорзЗржЬ ржмрж┐рж▓рзНржб ржХрж░рж╛рж░ рж╕ржорзЯ рж╕ржорзЯрзЗрж░ ржЕржкржЪрзЯ ржХржорж╛рждрзЗ ржПржмржВ ржПржлрж┐рж╢рж┐рзЯрзЗржирзНрж╕рж┐ ржмрж╛рзЬрж╛рждрзЗ <strong>Build Cache Optimization</strong> ржЕрждрзНржпржирзНржд ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржгред рж╕ржарж┐ржХ ржЙржкрж╛рзЯрзЗ ржХрзНржпрж╛рж╢ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржХрзЯрзЗржХ ржорж┐ржирж┐ржЯрзЗрж░ ржмрж┐рж▓рзНржб ржкрзНрж░рж╕рзЗрж╕ ржорж╛рждрзНрж░ ржХрзЯрзЗржХ рж╕рзЗржХрзЗржирзНржбрзЗ ржирж╛ржорж┐рзЯрзЗ ржЖржирж╛ рж╕ржорзНржнржмред</p><hr><h2 id="рзз-ржбржХрж╛рж░-рж▓рзЗржпрж╝рж╛рж░-ржХрзНржпрж╛рж╢рж┐ржВ-layer-caching" tabindex="-1">рзз. ржбржХрж╛рж░ рж▓рзЗржпрж╝рж╛рж░ ржХрзНржпрж╛рж╢рж┐ржВ (Layer Caching) <a class="header-anchor" href="#рзз-ржбржХрж╛рж░-рж▓рзЗржпрж╝рж╛рж░-ржХрзНржпрж╛рж╢рж┐ржВ-layer-caching" aria-label="Permalink to &quot;рзз. ржбржХрж╛рж░ рж▓рзЗржпрж╝рж╛рж░ ржХрзНржпрж╛рж╢рж┐ржВ (Layer Caching)&quot;">тАЛ</a></h2><p>ржбржХрж╛рж░ ржкрзНрж░рждрж┐ржЯрж┐ ржЗржирзНрж╕ржЯрзНрж░рж╛ржХрж╢ржиржХрзЗ (<code>RUN</code>, <code>COPY</code>, <code>ADD</code>) ржПржХржЯрж┐ ржЖрж▓рж╛ржжрж╛ рж▓рзЗрзЯрж╛рж░ рж╣рж┐рж╕рзЗржмрзЗ рж╕рзЗржн ржХрж░рзЗред</p><ul><li>ржпржЦржи ржЖржкржирж┐ ржкрзБржирж░рж╛рзЯ ржмрж┐рж▓рзНржб ржХрж░рзЗржи, ржбржХрж╛рж░ ржЪрзЗржХ ржХрж░рзЗ ржжрзЗржЦрзЗ рж╕рзЗржЗ рж▓рзЗрзЯрж╛рж░рзЗ ржХрзЛржирзЛ ржкрж░рж┐ржмрж░рзНрждржи рж╣рзЯрзЗржЫрзЗ ржХрж┐ржирж╛ред</li><li>ржпржжрж┐ ржкрж░рж┐ржмрж░рзНрждржи ржирж╛ рж╣рзЯ, рждржмрзЗ ржбржХрж╛рж░ ржЖржЧрзЗрж░ ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рж╛ ржХрзНржпрж╛рж╢ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред</li><li><strong>ржоржирзЗ рж░рж╛ржЦржмрзЗржи:</strong> ржпржжрж┐ ржХрзЛржирзЛ рж▓рзЗрзЯрж╛рж░рзЗрж░ ржХрзНржпрж╛рж╢ ржЗржиржнрзНржпрж╛рж▓рж┐ржб (Invalid) рж╣рзЯ, рждржмрзЗ рждрж╛рж░ ржкрж░рзЗрж░ рж╕ржм рж▓рзЗрзЯрж╛рж░ ржкрзБржирж░рж╛рзЯ ржмрж┐рж▓рзНржб рж╣ржмрзЗред</li></ul><hr><h2 id="рзи-ржХрзНржпрж╛рж╢-ржорж╛ржЙржирзНржЯрж┐ржВ-cache-mounting" tabindex="-1">рзи. ржХрзНржпрж╛рж╢ ржорж╛ржЙржирзНржЯрж┐ржВ (Cache Mounting) <a class="header-anchor" href="#рзи-ржХрзНржпрж╛рж╢-ржорж╛ржЙржирзНржЯрж┐ржВ-cache-mounting" aria-label="Permalink to &quot;рзи. ржХрзНржпрж╛рж╢ ржорж╛ржЙржирзНржЯрж┐ржВ (Cache Mounting)&quot;">тАЛ</a></h2><p>BuildKit-ржПрж░ ржПржХржЯрж┐ ржкрж╛ржУрзЯрж╛рж░ржлрзБрж▓ ржлрж┐ржЪрж╛рж░ рж╣рж▓рзЛ <code>type=cache</code> ржорж╛ржЙржирзНржЯред ржПржЯрж┐ ржмрж┐рж╢рзЗрж╖ ржХрж░рзЗ ржкрзНржпрж╛ржХрзЗржЬ ржорзНржпрж╛ржирзЗржЬрж╛рж░ржЧрзБрж▓рзЛрж░ (<code>pip</code>, <code>npm</code>, <code>apt</code>) ржЬржирзНржп ржЦрзБржм ржХрж╛рж░рзНржпржХрж░ред</p><div class="language-dockerfile vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">dockerfile</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="${ssrRenderStyle({ "--shiki-light": "#6A737D", "--shiki-dark": "#6A737D" })}"># Pip-ржПрж░ ржЬржирзНржп ржХрзНржпрж╛рж╢ ржорж╛ржЙржирзНржЯ ржЙржжрж╛рж╣рж░ржг</span></span>
<span class="line"><span style="${ssrRenderStyle({ "--shiki-light": "#D73A49", "--shiki-dark": "#F97583" })}">RUN</span><span style="${ssrRenderStyle({ "--shiki-light": "#24292E", "--shiki-dark": "#E1E4E8" })}"> --mount=type=cache,target=/root/.cache/pip \\</span></span>
<span class="line"><span style="${ssrRenderStyle({ "--shiki-light": "#24292E", "--shiki-dark": "#E1E4E8" })}">    pip install -r requirements.txt</span></span></code></pre></div><p><strong>рж╕рзБржмрж┐ржзрж╛:</strong> ржпржжрж┐ ржЖржкржирж┐ <code>requirements.txt</code>-ржП ржПржХржЯрж┐ ржирждрзБржи ржкрзНржпрж╛ржХрзЗржЬ ржпрзЛржЧ ржХрж░рзЗржи, рждржмрзЗ ржбржХрж╛рж░ рж╢рзБржзрзБржорж╛рждрзНрж░ рж╕рзЗржЗ ржкрзНржпрж╛ржХрзЗржЬржЯрж┐ ржбрж╛ржЙржирж▓рзЛржб ржХрж░ржмрзЗ, ржЖржЧрзЗрж░ ржкрзНржпрж╛ржХрзЗржЯржЧрзБрж▓рзЛ ржХрзНржпрж╛рж╢ ржерзЗржХрзЗ ржирж┐рзЯрзЗ ржирзЗржмрзЗред</p><hr><h2 id="рзй-ржорж╛рж▓рзНржЯрж┐-рж╕рзНржЯрзЗржЬ-ржХрзНржпрж╛рж╢рж┐ржВ-multi-stage-caching" tabindex="-1">рзй. ржорж╛рж▓рзНржЯрж┐-рж╕рзНржЯрзЗржЬ ржХрзНржпрж╛рж╢рж┐ржВ (Multi-stage Caching) <a class="header-anchor" href="#рзй-ржорж╛рж▓рзНржЯрж┐-рж╕рзНржЯрзЗржЬ-ржХрзНржпрж╛рж╢рж┐ржВ-multi-stage-caching" aria-label="Permalink to &quot;рзй. ржорж╛рж▓рзНржЯрж┐-рж╕рзНржЯрзЗржЬ ржХрзНржпрж╛рж╢рж┐ржВ (Multi-stage Caching)&quot;">тАЛ</a></h2><p>ржорж╛рж▓рзНржЯрж┐-рж╕рзНржЯрзЗржЬ ржмрж┐рж▓рзНржбрзЗ рж╢рзБржзрзБржорж╛рждрзНрж░ ржлрж╛ржЗржирж╛рж▓ рж╕рзНржЯрзЗржЬрзЗрж░ ржЗржорзЗржЬ ржЬрзЗржирж╛рж░рзЗржЯ рж╣рзЯред ржХрж┐ржирзНрждрзБ BuildKit ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржЖржкржирж┐ ржЗржирзНржЯрж╛рж░ржорж┐ржбрж┐рзЯрзЗржЯ рж╕рзНржЯрзЗржЬржЧрзБрж▓рзЛржХрзЗржУ ржХрзНржпрж╛рж╢ рж╣рж┐рж╕рзЗржмрзЗ рж╕рзНржЯрзЛрж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред</p><hr><h2 id="рзк-ржХрзНржпрж╛рж╢-ржЗржиржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи-cache-invalidation" tabindex="-1">рзк. ржХрзНржпрж╛рж╢ ржЗржиржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи (Cache Invalidation) <a class="header-anchor" href="#рзк-ржХрзНржпрж╛рж╢-ржЗржиржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи-cache-invalidation" aria-label="Permalink to &quot;рзк. ржХрзНржпрж╛рж╢ ржЗржиржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи (Cache Invalidation)&quot;">тАЛ</a></h2><p>ржХрзНржпрж╛рж╢ ржХржЦржи ржХрж╛ржЬ ржХрж░ржмрзЗ ржирж╛?</p><ul><li><code>COPY . .</code> ржХрж░рж╛рж░ рж╕ржорзЯ ржпржжрж┐ ржХрзЛржирзЛ ржлрж╛ржЗрж▓рзЗ ржкрж░рж┐ржмрж░рзНрждржи рж╣рзЯред</li><li>ржХрзЛржирзЛ <code>RUN</code> ржХржорж╛ржирзНржбрзЗрж░ ржЖржЧрзЗ ржпржжрж┐ ржЕржирзНржп ржХрзЛржирзЛ рж▓рзЗрзЯрж╛рж░ ржкрж░рж┐ржмрж░рзНрждржи рж╣рзЯред</li></ul><p><strong>ржмрзЗрж╕рзНржЯ ржкрзНрж░рзНржпрж╛ржХржЯрж┐рж╕:</strong> ржбржХрж╛рж░ржлрж╛ржЗрж▓рзЗ рж╕ржм рж╕ржорзЯ рж╕рзЗржЗ ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛ ржЖржЧрзЗ ржХржкрж┐ ржХрж░рзБржи ржпрж╛ ржШржиржШржи ржкрж░рж┐ржмрж░рзНрждржи рж╣рзЯ ржирж╛ (ржпрзЗржоржи: <code>package.json</code> ржмрж╛ <code>go.mod</code>)ред</p><div class="language-dockerfile vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">dockerfile</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="${ssrRenderStyle({ "--shiki-light": "#6A737D", "--shiki-dark": "#6A737D" })}"># ржнрж╛рж▓рзЛ ржкрзНрж░рзНржпрж╛ржХржЯрж┐рж╕</span></span>
<span class="line"><span style="${ssrRenderStyle({ "--shiki-light": "#D73A49", "--shiki-dark": "#F97583" })}">COPY</span><span style="${ssrRenderStyle({ "--shiki-light": "#24292E", "--shiki-dark": "#E1E4E8" })}"> package.json .</span></span>
<span class="line"><span style="${ssrRenderStyle({ "--shiki-light": "#D73A49", "--shiki-dark": "#F97583" })}">RUN</span><span style="${ssrRenderStyle({ "--shiki-light": "#24292E", "--shiki-dark": "#E1E4E8" })}"> npm install</span></span>
<span class="line"><span style="${ssrRenderStyle({ "--shiki-light": "#D73A49", "--shiki-dark": "#F97583" })}">COPY</span><span style="${ssrRenderStyle({ "--shiki-light": "#24292E", "--shiki-dark": "#E1E4E8" })}"> . .</span></span></code></pre></div><hr><h2 id="рзл-рж░рж┐ржорзЗрж╛ржЯ-ржХрзНржпрж╛рж╢-remote-cache" tabindex="-1">рзл. рж░рж┐ржорзЛржЯ ржХрзНржпрж╛рж╢ (Remote Cache) <a class="header-anchor" href="#рзл-рж░рж┐ржорзЗрж╛ржЯ-ржХрзНржпрж╛рж╢-remote-cache" aria-label="Permalink to &quot;рзл. рж░рж┐ржорзЛржЯ ржХрзНржпрж╛рж╢ (Remote Cache)&quot;">тАЛ</a></h2><p>CI/CD ржкрж╛ржЗржкрж▓рж╛ржЗржирзЗ ржХрж╛ржЬ ржХрж░рж╛рж░ рж╕ржорзЯ ржПржХ ржмрж┐рж▓рзНржбрзЗрж░ ржХрзНржпрж╛рж╢ ржЕржирзНржп ржмрж┐рж▓рзНржбрзЗ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ ржирж╛ ржХрж╛рж░ржг ржкрзНрж░рждрж┐ржмрж╛рж░ ржПржХржЯрж┐ ржирждрзБржи ржПржиржнрж╛рзЯрж░ржиржорзЗржирзНржЯ рждрзИрж░рж┐ рж╣рзЯред BuildKit-ржПрж░ ржорж╛ржзрзНржпржорзЗ ржЖржкржирж┐ ржЖржкржирж╛рж░ ржЗржорзЗржЬ рж░рзЗржЬрж┐рж╕рзНржЯрзНрж░рж┐рждрзЗ (Docker Hub/GHCR) ржХрзНржпрж╛рж╢ ржкрзБрж╢ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="${ssrRenderStyle({ "--shiki-light": "#6F42C1", "--shiki-dark": "#B392F0" })}">docker</span><span style="${ssrRenderStyle({ "--shiki-light": "#032F62", "--shiki-dark": "#9ECBFF" })}"> buildx</span><span style="${ssrRenderStyle({ "--shiki-light": "#032F62", "--shiki-dark": "#9ECBFF" })}"> build</span><span style="${ssrRenderStyle({ "--shiki-light": "#005CC5", "--shiki-dark": "#79B8FF" })}"> --push</span><span style="${ssrRenderStyle({ "--shiki-light": "#005CC5", "--shiki-dark": "#79B8FF" })}"> \\</span></span>
<span class="line"><span style="${ssrRenderStyle({ "--shiki-light": "#005CC5", "--shiki-dark": "#79B8FF" })}">  --cache-from=user/app:cache</span><span style="${ssrRenderStyle({ "--shiki-light": "#005CC5", "--shiki-dark": "#79B8FF" })}"> \\</span></span>
<span class="line"><span style="${ssrRenderStyle({ "--shiki-light": "#005CC5", "--shiki-dark": "#79B8FF" })}">  --cache-to=user/app:cache,mode=max</span><span style="${ssrRenderStyle({ "--shiki-light": "#005CC5", "--shiki-dark": "#79B8FF" })}"> \\</span></span>
<span class="line"><span style="${ssrRenderStyle({ "--shiki-light": "#005CC5", "--shiki-dark": "#79B8FF" })}">  -t</span><span style="${ssrRenderStyle({ "--shiki-light": "#032F62", "--shiki-dark": "#9ECBFF" })}"> user/app:latest</span><span style="${ssrRenderStyle({ "--shiki-light": "#032F62", "--shiki-dark": "#9ECBFF" })}"> .</span></span></code></pre></div><hr><h2 id="рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк-summary" tabindex="-1">рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк (Summary) <a class="header-anchor" href="#рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк-summary" aria-label="Permalink to &quot;рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк (Summary)&quot;">тАЛ</a></h2><p>ржмрж┐рж▓рзНржб ржХрзНржпрж╛рж╢ ржЕржкрзНржЯрж┐ржорж╛ржЗржЬрзЗрж╢ржи ржЖржкржирж╛рж░ ржбрзЗржнрж▓ржкржорзЗржирзНржЯ рж▓рж╛ржЗржлрж╕рж╛ржЗржХрзЗрж▓ржХрзЗ ржЕржирзЗржХ ржмрзЗрж╢рж┐ ржлрж╛рж╕рзНржЯ ржХрж░рзЗред рж▓рзЗрзЯрж╛рж░рж┐ржВ ржЕрж░рзНржбрж╛рж░ ржПржмржВ BuildKit-ржПрж░ ржХрзНржпрж╛рж╢ ржорж╛ржЙржирзНржЯ ржлрж┐ржЪрж╛рж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржкрзНрж░рждрж┐ржЯрж┐ ржкрзНрж░ржлрзЗрж╢ржирж╛рж▓ ржбржХрж╛рж░ ржЗржЙржЬрж╛рж░рзЗрж░ ржЬрж╛ржирж╛ ржЙржЪрж┐рждред</p><hr><div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p>рж╕ржм рж╕ржорзЯ <code>.dockerignore</code> ржлрж╛ржЗрж▓ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи ржпрж╛рждрзЗ ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржлрж╛ржЗрж▓ (ржпрзЗржоржи: <code>node_modules</code>, <code>.git</code>) ржХрзНржпрж╛рж╢ ржЗржиржнрзНржпрж╛рж▓рж┐ржб ржирж╛ ржХрж░рждрзЗ ржкрж╛рж░рзЗред</p></div></div>`);
}
const _sfc_setup = _sfc_main.setup;
_sfc_main.setup = (props, ctx) => {
  const ssrContext = useSSRContext();
  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add("docker/cache-optimization.md");
  return _sfc_setup ? _sfc_setup(props, ctx) : void 0;
};
const cacheOptimization = /* @__PURE__ */ _export_sfc(_sfc_main, [["ssrRender", _sfc_ssrRender]]);
export {
  __pageData,
  cacheOptimization as default
};
