# Spanning Tree Protocol (STP): Preventing Loops (এসটিপি এর মূল ধারণা)

একটি নেটওয়ার্কে রিডানডেন্সি (Redundancy) বা ব্যাকআপ লিংকের জন্য আমরা প্রায়ই একাধিক সুইচকে একে অপরের সাথে লুপ আকারে যুক্ত করি। কিন্তু এর ফলে তৈরি হতে পারে ভয়ঙ্কর **Layer 2 Loop**, যা পুরো নেটওয়ার্ককে অচল করে দিতে পারে। এই সমস্যা সমাধানের হিরো হলো **STP**।

---

## ১. ব্রডকাস্ট স্টর্ম এবং লুপ (Broadcast Storms & Loops)
যদি দুটি সুইচের মধ্যে দুটি আলাদা ক্যাবল থাকে, তবে একটি ব্রডকাস্ট ফ্রেম (যেমন: ARP) সুইচে পৌঁছালে সেটি অনন্তকাল ধরে ঘুরতে থাকে।
- **Broadcast Storm:** ফ্রেমটি সেকেন্ডে হাজার বার ডুপ্লিকেট হয়ে ব্যান্ডউইথ শেষ করে দেয়।
- **MAC Table Instability:** সুইচের ম্যাক অ্যাড্রেস টেবিল বারবার পরিবর্তিত হতে থাকে, ফলে সুইচ ডাটা কোথায় পাঠাবে তা বুঝতে পারে না।

---

## ২. STP কীভাবে কাজ করে?
STP নেটওয়ার্কের একটি লজিক্যাল ম্যাপ তৈরি করে এবং লুপ এড়াতে অপ্রয়োজনীয় লিংকগুলোকে সাময়িকভাবে ব্লক করে রাখে।

### ৩. রুট ব্রিজ সিলেকশন (Root Bridge Selection)
নেটওয়ার্কের সব সুইচের মধ্যে থেকে একটি মেইন সুইচ বা কেন্দ্র নির্বাচন করা হয় যাকে **Root Bridge** বলে।
- এটি নির্ভর করে **Bridge ID** এর ওপর (Priority + MAC Address)।
- যার প্রায়োরিটি বা ম্যাক অ্যাড্রেস সবচেয়ে কম, সে-ই রুট ব্রিজ হয়।

---

## ৪. পোর্টের বিভিন্ন অবস্থা (Port States)
লুপ চেক করার সময় সুইচের পোর্ট কয়েকটি ধাপ অতিক্রম করে:

| পোর্টের অবস্থা | বর্ণনা (Description) | ডাটা ফরওয়ার্ড? |
| :--- | :--- | :--- |
| **Blocking** | কেবল BPDU মেসেজ রিসিভ করে, অন্য সব ডাটা ব্লক থাকে। | না |
| **Listening** | লুপ আছে কি না তা শোনার চেষ্টা করে। | না |
| **Learning** | ম্যাক অ্যাড্রেস টেবিল তৈরি করা শুরু করে। | না |
| **Forwarding** | স্বাভাবিকভাবে ডাটা আদান-প্রদান শুরু করে। | হ্যাঁ |

---

## ৫. BPDU (Bridge Protocol Data Unit)
সুইচগুলো একে অপরের সাথে যোগাযোগের জন্য যে বিশেষ ডাটা প্যাকেট ব্যবহার করে, তাকে **BPDU** বলে। প্রতি ২ সেকেন্ড পরপর এটি পাঠানো হয় নেটওয়ার্কের অবস্থা জানানোর জন্য।

---

## ৬. এসটিপি এর প্রকারভেদসমূহ
- **PVST+ (Per-VLAN Spanning Tree):** সিসকোর ডিফল্ট এসটিপি যা প্রতিটি ভিল্যানের জন্য আলাদা আলাদা ক্যালকুলেশন করে।
- **RSTP (Rapid Spanning Tree):** এটি সাধারণ এসটিপি থেকে অনেক দ্রুত (২-৫ সেকেন্ডের মধ্যে কনভারজেন্স শেষ করে)।
- **MSTP (Multiple Spanning Tree):** অনেকগুলো ভিল্যানকে একটি গ্রুপে রেখে ক্যালকুলেশন করে যেন সুইচের ওপর চাপ কম পড়ে।

---

## ৭. ডেভঅপস পারসপেক্টিভ: ট্রাবলশুটিং ও নেটওয়ার্ক কনভারজেন্স
- **Downtime Minimization:** ডাটা সেন্টারে সবসময় **RSTP (802.1w)** ব্যবহার করা উচিত যেন কোনো ক্যাবল ছিঁড়ে গেলে নিমিষেই ব্যাকআপ লিংক চালু হয়।
- **PortFast:** ইউজার পিসি বা সার্ভারের পোর্টে **PortFast** এনাবল করা উচিত যেন পোর্টটি সাথে সাথেই Forwarding মোডে চলে যায় (Listening/Learning ধাপ স্কিপ করে)। এতে আইপি পেতে দেরি হয় না।
- **Root Protection:** আপনি নিশ্চয়ই চাবেন না আপনার অফিসের একটি সস্তা রিসেপশন সুইচ হঠাৎ করে রুট ব্রিজ হয়ে যাক। তাই কোর সুইচের প্রায়োরিটি সবসময় ম্যানুয়ালি কম রাখা বুদ্ধিমানের কাজ।

---

::: tip মনে রাখুন!
STP-কে বলা হয় নেটওয়ার্কের সেফটি নেট। এটি ব্যাকআপ কানেকশন রাখতে দেয় আবার লুপ হতেও বাধা দেয়। 
:::
